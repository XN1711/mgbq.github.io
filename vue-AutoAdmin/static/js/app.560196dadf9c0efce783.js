webpackJsonp([5],{"4yu5":function(e,n){},"9ebC":function(e,n,t){"use strict";n.a=["Span","Pagination","Switch","Button","Table","table-column","Breadcrumb","breadcrumb-item","Tabs","tab-pane"]},IcnI:function(e,n,t){"use strict";var a=t("VCXJ"),o=t("9rMa"),r=t("uAC3"),c=t.n(r),u={state:{language:c.a.get("language")||"en"},mutations:{SET_LANGUAGE:function(e,n){e.language=n,c.a.set("language",n)}},actions:{setLanguage:function(e,n){(0,e.commit)("SET_LANGUAGE",n)}}},i=t("rVsN"),s=t.n(i),l=t("aozt"),d=t.n(l),m=t("epGn"),f=t("TIfe"),p=d.a.create({baseURL:"https://easy-mock.com/mock/5a72c1ecc76727050336e0bc/mdm/",timeout:15e3});p.interceptors.request.use(function(e){return k.getters.token&&(e.headers["X-Token"]=Object(f.a)()),e},function(e){console.log(e),s.a.reject(e)}),p.interceptors.response.use(function(e){var n=e.data;return 2e4!==n.code?(Object(m.Message)({message:n.data,type:"error",duration:5e3}),50008!==n.code&&50012!==n.code&&50014!==n.code||m.MessageBox.confirm("你已被登出，可以取消继续留在该页面，或者重新登录","确定登出",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then(function(){k.dispatch("FedLogOut").then(function(){location.reload()})}),s.a.reject("error")):e.data},function(e){return console.log("err"+e),Object(m.Message)({message:e.message,type:"error",duration:5e3}),s.a.reject(e)});var h=p;var g={state:{token:Object(f.a)(),name:"",avatar:"",roles:[]},mutations:{SET_TOKEN:function(e,n){e.token=n},SET_NAME:function(e,n){e.name=n},SET_AVATAR:function(e,n){e.avatar=n},SET_ROLES:function(e,n){e.roles=n}},actions:{Login:function(e,n){var t=e.commit,a=n.username.trim();return new s.a(function(e,o){(function(e,n){return h({url:"/user/login",method:"post",data:{username:e,password:n}})})(a,n.password).then(function(n){var a=n.data;Object(f.c)(a.token),t("SET_TOKEN",a.token),e()}).catch(function(e){o(e)})})},GetInfo:function(e){var n=e.commit,t=e.state;return new s.a(function(e,a){var o;(o=t.token,h({url:"/user/info",method:"get",params:{token:o}})).then(function(t){var a=t.data;n("SET_ROLES",a.roles),n("SET_NAME",a.name),n("SET_AVATAR",a.avatar),e(t)}).catch(function(e){a(e)})})},LogOut:function(e){var n=e.commit,t=e.state;return new s.a(function(e,a){(t.token,h({url:"/user/logout",method:"post"})).then(function(){n("SET_TOKEN",""),n("SET_ROLES",[]),Object(f.b)(),e()}).catch(function(e){a(e)})})},FedLogOut:function(e){var n=e.commit;return new s.a(function(e){n("SET_TOKEN",""),Object(f.b)(),e()})}}},b={language:function(e){return e.app.language},token:function(e){return e.user.token},name:function(e){return e.user.name},avatar:function(e){return e.user.avatar},routers:function(e){return e.permission.routers},addRouters:function(e){return e.permission.addRouters},roles:function(e){return e.user.roles}},v=t("YaEn");var T={state:{routers:v.b,addRouters:[]},mutations:{SET_ROUTERS:function(e,n){e.addRouters=n,e.routers=v.b.concat(n),console.log("state.routers",e.routers)}},actions:{GenerateRoutes:function(e,n){var t=e.commit;return new s.a(function(e){var a=n.roles,o=void 0;a.indexOf("admin")>=0?(console.log("admin>=0"),o=v.a):(console.log("admin<0"),o=function e(n,t){return n.filter(function(n){return!!function(e,n){return!n.meta||!n.meta.roles||e.some(function(e){return n.meta.roles.indexOf(e)>=0})}(t,n)&&(n.children&&n.children.length&&(n.children=e(n.children,t)),!0)})}(v.a,a)),console.log("accessedRouters",o),t("SET_ROUTERS",o),e()})}}};a.default.use(o.a);var E=new o.a.Store({modules:{app:u,user:g,permission:T},getters:b}),k=n.a=E},NHnr:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t("VCXJ"),o=t("9rMa"),r={render:function(){var e=this.$createElement,n=this._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]};var c=t("Z0/y")({name:"App"},r,!1,function(e){t("4yu5")},null,null).exports,u=t("YaEn"),i=t("IcnI"),s=t("4YfN"),l=t.n(s),d=t("UAU/"),m=t("uAC3"),f=t.n(m),p=t("HHok"),h=t.n(p),g=t("OXfK"),b=t.n(g);a.default.use(d.a);var v={en:l()({},{navbar:{title:"Automatic charging system",languageSwitch:"languageSwitch",theme:"Theme"},skin:{blue:"blue",green:"green",red:"red",purple:"purple",default:"default"},route:{Readme:"Readme",permission:"permission"}},h.a),zh:l()({},{navbar:{title:"自动化装逼系统",languageSwitch:"语言切换",theme:"主题"},skin:{blue:"天空蓝",green:"典雅绿",red:"樱桃红",purple:"贵族紫",default:"默认"},route:{Readme:"自述",permission:"权限"}},b.a)},T=new d.a({locale:f.a.get("language")||"en",messages:v}),E=t("kOl9"),k=t("epGn"),O=t.n(k),R=(t("qbEQ"),t("TIfe")),S=["/login","/authredirect"];u.c.beforeEach(function(e,n,t){Object(R.a)()?"/login"===e.path?t():0===i.a.getters.roles.length?(console.log("roles====0"),i.a.dispatch("GetInfo").then(function(n){var a=n.data.roles;console.log("roles?",a),i.a.dispatch("GenerateRoutes",{roles:a}).then(function(){console.log("addrouters",i.a.getters.addRouters),u.c.addRoutes(i.a.getters.addRouters),t(l()({},e,{replace:!0}))})}).catch(function(){i.a.dispatch("FedLogOut").then(function(){k.Message.error("验证失败,请重新登录"),t({path:"/login"})})})):(console.log("====1"),t()):-1!==S.indexOf(e.path)?t():t("/login")}),a.default.use(o.a),a.default.use(O.a,{size:"medium",i18n:function(e,n){return T.t(e,n)}}),localStorage.getItem("themeValue")?E.a.changeTheme(localStorage.getItem("themeValue")):E.a.changeTheme("default"),a.default.config.productionTip=!1,new a.default({el:"#app",router:u.c,store:i.a,i18n:T,components:{App:c},template:"<App/>"})},TIfe:function(e,n,t){"use strict";n.a=function(){return o.a.get(r)},n.c=function(e){return o.a.set(r,e)},n.b=function(){return o.a.remove(r)};var a=t("uAC3"),o=t.n(a),r="token"},YaEn:function(e,n,t){"use strict";t.d(n,"b",function(){return r}),t.d(n,"a",function(){return c});var a=t("VCXJ"),o=t("zO6J");a.default.use(o.a);var r=[{path:"/",redirect:"/login",hidden:!0},{path:"/login",name:"登录页面",hidden:!0,component:function(e){return t.e(2).then(function(){var n=[t("ook+")];e.apply(null,n)}.bind(this)).catch(t.oe)}},{path:"/Readme",index:"Readme",meta:{title:"Readme",icon:"el-icon-menu"},component:function(e){return t.e(0).then(function(){var n=[t("MpTN")];e.apply(null,n)}.bind(this)).catch(t.oe)},children:[{name:"Readme",path:"/",meta:{title:"Readme",icon:"el-icon-menu"},component:function(e){return t.e(3).then(function(){var n=[t("Kblq")];e.apply(null,n)}.bind(this)).catch(t.oe)}}]}];n.c=new o.a({routes:r});var c=[{path:"/permission",meta:{title:"permission",icon:"el-icon-setting",roles:["admin"]},component:function(e){return t.e(0).then(function(){var n=[t("MpTN")];e.apply(null,n)}.bind(this)).catch(t.oe)},children:[{name:"permission",path:"/permission",meta:{title:"permission",icon:"el-icon-menu",roles:["admin"]},component:function(e){return t.e(1).then(function(){var n=[t("9jHE")];e.apply(null,n)}.bind(this)).catch(t.oe)}}]},{path:"*",redirect:"/404",hidden:!0}]},kOl9:function(e,n,t){"use strict";(function(e){t.d(n,"a",function(){return o});var a=t("9ebC"),o={changeTheme:function(n){switch(n){case"blue":e(".header").css("background-color","#409eff");break;case"green":e(".header").css("background-color","#009a61");break;case"red":e(".header").css("background-color","#f44336");break;case"purple":e(".header").css("background-color","#7B7DE5");break;default:e(".header").css("background-color","#21baa9")}for(var t=a.a,o=0,r=t.length;o<r;o++){c("../../static/theme/"+n+"/"+t[o].toLowerCase()+".css")}function c(e){var n=document.getElementsByTagName("head")[0],t=document.createElement("link");t.href=e,t.rel="stylesheet",t.type="text/css",n.appendChild(t)}localStorage.setItem("themeValue",n)}}}).call(n,t("slT5"))},qbEQ:function(e,n){}},["NHnr"]);